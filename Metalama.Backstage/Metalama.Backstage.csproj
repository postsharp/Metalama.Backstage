<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFrameworks>netstandard2.0</TargetFrameworks>
        <MetalamaBackstageDirectory Condition="'$(MetalamaBackstageDirectory)'==''">$(MSBuildProjectDirectory)</MetalamaBackstageDirectory>
    </PropertyGroup>

    <PropertyGroup>
        <RootNamespace>Metalama.Backstage</RootNamespace>
        <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    </PropertyGroup>

    <ItemGroup>
      <None Remove="Telemetry\public.key" />
      <EmbeddedResource Include="$(MetalamaBackstageDirectory)\Telemetry\public.key" />
    </ItemGroup>

    <ItemGroup>
        <PackageReference Include="Microsoft.Bcl.HashCode" Version="$(MicrosoftBclHashCodeVersion)" />
        <PackageReference Include="Newtonsoft.Json" Version="$(NewtonsoftJsonVersion)" />
        <PackageReference Include="System.IO.Packaging" Version="6.0.0" />
    </ItemGroup>

  <ItemGroup>
        <ProjectReference Include="..\Metalama.Backstage.Worker\Metalama.Backstage.Worker.csproj"
                          ReferenceOutputAssembly="false"
                          SkipGetTargetFrameworkProperties="true"
                          SetTargetFramework="TargetFramework=netcoreapp3.1"
                          Condition="'$(MSBuildProjectFile)'!='Metalama.Backstage.Worker.csproj'" />
    </ItemGroup>

<ItemGroup>
        <ProjectReference Include="..\Metalama.Backstage.Worker\Metalama.Backstage.Worker.csproj"
                          ReferenceOutputAssembly="false"
                          SkipGetTargetFrameworkProperties="true"
                          SetTargetFramework="TargetFramework=netframework4.7.2"
                          Condition="'$(MSBuildProjectFile)'!='Metalama.Backstage.Worker.csproj'" />
    </ItemGroup>

    <ItemGroup>
        <InternalsVisibleTo Include="Metalama.Backstage.Tests" />
        <InternalsVisibleTo Include="Metalama.Backstage.TestHelpers" />
    </ItemGroup>

</Project>
